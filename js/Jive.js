(function(){function d(){this.state=new d.State;return this}function f(a){window.addEventListener?window.addEventListener(a,g,false):window.attachEvent("on"+a,g)}function h(a){var b;document.createEvent?(b=document.createEvent("HTMLEvents"),b.initEvent(a,true,true)):(b=document.createEventObject(),b.eventType="on"+a);document.createEvent?window.dispatchEvent(b):window.fireEvent(b.eventType,b)}function g(){for(var a in e)e[a].dispatch()}var i,e=[];d.prototype={routes:[],bind:function(){e.push(this);
return this},unbind:function(){for(var a in e)this===e[a]&&delete e[a];return this},set:function(a,b,c,e){this.routes[this.routes.length]=new d.Route(a,b,c,e);return this},get:function(a){for(var b in this.routes)if(a===this.routes[b].name)return this.routes[b];throw'Route "'+a.toString()+'" does not exist.';},has:function(a){for(var b in this.routes)if(a===this.routes[b].name)return true;return false},remove:function(a){var b=[],c;for(c in this.routes)a!==this.routes[c].name&&(b[c]=this.routes[c]);
this.routes=b;return this},dispatch:function(a){for(var b in this.routes)if(this.routes[b].execute(a||this.state.get()))return true;return false},go:function(a,b,c){this.state.push(this.get(a).generate(b),c);return this},generate:function(a,b){this.get(a).generate(b);return this}};d.Route=function(a,b,c,d){typeof a==="function"?(d=a,c="",b=/.*/,a=this.routes.length):a instanceof RegExp?(d=typeof b==="string"?c:b,c=typeof b==="string"?b:"",b=a,a=this.routes.length):typeof c==="function"&&(d=c,c=a);
this.name=a;this.regex=b;this.reverse=c;this.callback=d};d.Route.prototype={name:null,regex:/.*/,reverse:"",callback:function(){},match:function(a){return a.match(this.regex)},execute:function(a){var b=this.match(a);if(b===null)return false;b.unshift(a);this.callback.apply(this,b);return true},generate:function(a){var b=this.reverse,c;for(c in a)b.replace(RegExp("/:"+c+"/g"),a[c]);return b}};var j=false;d.State=function(){j||("onpopstate"in window?f("popstate"):"onhashchange"in window?f("hashchange"):
(f("hashchange"),setInterval(function(){if(i!==window.location.hash)i=window.location.hash,h("hashchange")},100)),j=true)};d.State.prototype={states:{},enabled:false,get:function(){return this.enabled&&window.history.pushState?window.location.href.replace(/http(s)?\:\/\/[^\/]+/,""):window.location.hash.substring(1)},push:function(a,b,c){this.enabled&&window.history.pushState?a?window.history.pushState(b,c,a):h("popstate"):window.location.hash=a;this.states[a]=b;return this},data:function(a){a=a||
this.get();return typeof this.states[a]==="undefined"?null:this.states[a]}};window.Jive=d;window.jive=new d})();